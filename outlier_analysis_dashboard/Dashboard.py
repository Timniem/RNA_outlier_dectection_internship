from Widgets import Widgets
import panel as pn

class Dashboard:
    def __init__(self, fraser_data, outrider_data, mae_data):
        self.fraser_data = fraser_data
        self.outrider_data = outrider_data
        self.mae_data = mae_data
        self.widgets = Widgets(fraser_data=self.fraser_data, outrider_data=self.outrider_data, mae_data=self.mae_data, genepanels=['none','PID'])

    def run(self):
        template = pn.Column(
            pn.pane.Markdown(
            """
            <h1 style="color:grey">
            <svg width="101" height="39" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" overflow="hidden"><defs><clipPath id="clip0"><rect x="1673" y="287" width="101" height="39"/></clipPath><clipPath id="clip1"><rect x="-0.0108261" y="-0.353322" width="615749" height="237765"/></clipPath><image width="669" height="73" xlink:href="data:image/png;base64,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" preserveAspectRatio="none" id="img2"></image><clipPath id="clip3"><rect x="1762676" y="142.247" width="615633" height="237764"/></clipPath></defs><g clip-path="url(#clip0)" transform="translate(-1673 -287)"><g clip-path="url(#clip1)" transform="matrix(0.000164028 0 0 0.000164028 1673 287)"><g clip-path="url(#clip3)" transform="matrix(1.00019 0 0 1 -1763008 -142.454)"><use width="100%" height="100%" xlink:href="#img2" transform="scale(3820.76 3820.76)"></use></g></g></g></svg> 
             RNA seq outliers </h1>
            """
        ),
            pn.Row(
            pn.Column(pn.Row(self.widgets.select_patient),
                                pn.Row(self.widgets.genepanel_filter),
                                pn.Row(self.widgets.gene_input),
                                pn.Row(self.widgets.hpo_input),
                                pn.Row(pn.widgets.StaticText(name='controls', value="FRASER")),
                                pn.Row(self.widgets.pval_slider_fraser),
                                pn.Row(self.widgets.delta_psi_slider),
                                pn.Row(pn.widgets.StaticText(name='controls', value="OUTRIDER")),
                                pn.Row(self.widgets.pval_slider_outrider),
                                pn.Row(self.widgets.zscore_slider),
                                pn.Row(pn.widgets.StaticText(name='controls', value="MAE")),
                                pn.Row(self.widgets.pval_slider_mae),
                                pn.Row(self.widgets.log2fc_slider_mae)),
            pn.Column(
                pn.Row(
                    pn.Card(pn.Row(self.widgets.fraser_tab, self.widgets.scatter_plot_fraser(), styles={'background': '#f3f3f3'}), title='Splicing outliers FRASER', collapsible=False),
                ),
                pn.Row(
                    pn.Card(pn.Row(self.widgets.outrider_tab, self.widgets.scatter_plot_outrider(), styles={'background': '#f3f3f3'}), title='Expression outliers OUTRIDER', collapsible=False)
                ),
                pn.Row(
                    pn.Card(pn.Row(self.widgets.mae_tab, self.widgets.mae_plot(), styles={'background': '#f3f3f3'}), title='Mono Allelic Expression variants', collapsible=False)
                )
                )
            )
        )
        return template
